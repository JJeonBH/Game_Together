<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.koreaIT.Game_Together.repository.ArticleRepository">

	<insert id="writeArticle">
		INSERT INTO article
			SET regDate = NOW()
				, updateDate = NOW()
				, memberId = #{memberId}
				, boardId = #{boardId}
				, title = #{title}
				, `body` = #{body};
	</insert>
	
	<select id="getLastInsertId" resultType="int">
		SELECT LAST_INSERT_ID();
	</select>
	
	<select id="getForPrintArticle" resultType="Article">
		SELECT A.*
			, M.nickname AS writerNickname
			, B.name AS boardName
			FROM article AS A
			INNER JOIN `member` AS M
			ON A.memberId = M.id
			INNER JOIN board AS B
			ON A.boardId = B.id
			WHERE A.id = #{id};
	</select>
	
	<update id="increaseViewCount">
		UPDATE article
			SET viewCount = viewCount + 1
			WHERE id = #{id};
	</update>

</mapper>